# Stonks

## Problem

I decided to try something noone else has before.

I made a bot to automatically trade stonks for me using AI and machine learning.

I wouldn't believe you if you told me it's unsecure!

[vuln.c](./vuln.c) nc mercury.picoctf.net 59616

## Solution

1. Let's connect to the attached service:

2. We can see from the source code that if we choose to buy stonks, we are able to enter a string which is used as the format string for printf.

3. This is vulnerable to a format string attack.

4. Let's print some variables from the stack using this vulnerability:

5. Variables from the stack were leaked as the token. After some leaking and decoding, we can find out that the flag starts at the 15th DWORD from our leak base.

6. We can automate the leak using the following script:

    [stonks.py](./stonks.py)

### Flag

picoCTF{I_l05t_4ll_my_m0n3y_6148be54}